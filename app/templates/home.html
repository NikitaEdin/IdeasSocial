{% extends 'base_with_menu.html' %}

{% block page_content %}
        <!-- Main centre column  -->
        <div class="">
            <!-- Flash messages -->
            {% with messages = get_flashed_messages(with_categories=true) %}
              <!--  any messages? -->
              {% if messages %}
                  <!-- loop messages -->
                  {% for category, message in messages %}
                      <div class="alert alert-{{category}} alert-dismissible fade show" role="alert">
                          {{ message}}
                          <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                      </div>
                  {% endfor %}

              {% endif %}
           {% endwith %}


            <!-- Create new IDEA post -->
            {% if current_user.is_authenticated %}
                <h4> Share yours ideas </h4>
                <form action="{{ url_for('home') }}" method="POST">
                    {{ form.hidden_tag() }}
                    
                    <div class="row">
                        <!-- Title Field -->
                        <div class="mb-1">
                            <!-- {{ form.title.label(class="form-label") }} -->
                            {{ form.title(class="form-control", placeholder="Enter post title") }}
                            {% if form.title.errors %}
                                <div class="text-danger">
                                    {{ form.title.errors[0] }}
                                </div>
                            {% endif %}
                        </div>
                
                        <!-- Content Field -->
                        <div class="mb-2">
                            <!-- {{ form.content.label(class="form-label") }} -->
                            {{ form.content(class="form-control", placeholder="Whatâ€™s happening?", rows="3", style="max-height:200px; min-height:75px;") }}
                            {% if form.content.errors %}
                                <div class="text-danger">
                                    {{ form.content.errors[0] }}
                                </div>
                            {% endif %}
                        </div>
                
                        <!-- Submit Button -->
                        <div class="">
                            {{ form.submit(class="btn btn-primary mb-1") }}
                        </div>
                    </div>
                </form>
                
                
            {% else %}
                <h4>Most recent posted ideas:</h4>
            {% endif %}
                <hr>
            <!-- Posts -->
            <div class="mt-3">
                {% for post in posts %}

                <div class="card card-post my-3">
                    <div class="px-3 pt-2 d-flex justify-content-between align-items-center" >
                      <!-- Header-LEFT (user name & pfp) -->
                        <div class="d-flex align-items-start" >
                            <div class="d-flex align-items-center" >
                                <img src="{{ post.author.get_pfp() }}" class="me-2" style="width:50px;">
                                <a class="card-title d-flex align-content-between">
                                    <a href="#" class="fs-6 text-decoration-none">{{ post.author.get_full_name() }}</a>
                                </a>
                            </div>
                        </div>
                        <!-- Header-RIGHT (options) -->
                        <div class="d-flex align-items-center ">
                            <a href="{{ url_for('view_post', post_id=post.id) }}" class="text-decoration-none text-muted2">
                                <i class="fas fa-eye me-1 "></i>
                                <span>View Post</span>
                            </a>
                        </div>

                    </div>
                    
                    <!-- Body -->
                    <div class="card-body pt-1">
                         <!-- Post Title -->
                        <h5 class="fw-medium my-0">{{ post.title }}</h5>

                        <!-- Post Content -->
                        <p class="fs-6 fw-light text-muted">
                            {{ post.content[:100] }}{% if post.content|length > 100 %}...{% endif %}
                        </p>
                        <div class="d-flex justify-content-between">
                            <div>
                                <a href="#" class="fw-light nav-link fs-6"> <span class="fas fa-heart me-1">
                                    </span> 100 </a>
                            </div>
                            <div>
                                <span class="fs-6 fw-light text-muted2"> <span class="fas fa-clock"> </span>
                                    {{ post.humanized_time }} 
                                </span>
                            </div>
                        </div>
                     
                    </div>
                </div>

                {% endfor %}
            </div>

        </div>

        
         




{% endblock %}

